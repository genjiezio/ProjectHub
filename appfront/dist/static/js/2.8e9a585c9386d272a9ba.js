webpackJsonp([2],{B0Iv:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("9KBo"),s=a("yTzw"),i=a("mtWM"),o=a.n(i),n={name:"uploadTemplate",props:["tableData","cla","pro"],data:function(){return{childrenCla:"",childrenPro:1,url:"",uploadUrl:"/teacher_api/upload_mark_file",data:{cla:this.childrenCla,proid:this.childrenPro,tid:this.$route.query.qtid}}},created:function(){this.url="http://127.0.0.1:8000"},watch:{pro:function(t){void 0!==t&&(this.childrenPro=t,this.data.proid=this.childrenPro,console.log(this.childrenPro))}},methods:{onSuccess:function(t,e,a){var l=this;this.$message(t.status+":"+t.msg),200===t.status?o.a.post("/teacher_api/upload_mark_temp",{params:{tid:this.$route.query.qtid,cla:this.childrenCla,proid:this.childrenPro}}).then(function(t){if(t.data.tableData)for(var e=0;e<t.data.tableData.length;e++)l.$set(l.tableData,e,t.data.tableData[e])}):this.$message("请选择课程和Project")}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-upload",{staticClass:"upload-demo",staticStyle:{display:"inline-block","margin-left":"2%"},attrs:{action:this.url+this.uploadUrl,data:this.data,"on-success":this.onSuccess}},[e("el-button",{attrs:{type:"text"}},[this._v("上传评分模板文件")])],1)},staticRenderFns:[]};var r=a("VU/8")(n,c,!1,function(t){a("bjel")},"data-v-052717a7",null).exports,d={components:{HeadLine:l.a,pageEnd:s.a,uploadTemplate:r},data:function(){return{tableData:[{name:"",fullScore:void 0,desc:""}],isEdit:!1,multipleSelection:[],classes:[""],pros:{},query:"",cla:"",pro:""}},created:function(){var t=this;this.query=this.$route.query.qtid,o.a.post("/teacher_api/get_class_pro",{tid:this.query},{headers:{"X-CSRFToken":document.cookie.split("=")[1]}}).then(function(e){t.tableData=[{name:"",fullScore:void 0,desc:""}],t.classes=e.data.classes,t.pros=e.data.pros}),this.cla="",this.pro=""},methods:{cancelSelect:function(){this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){var e=this;t.forEach(function(t){e.multipleSelection.push(t.name)})},deleteDone:function(){var t=this,e=function(e){t.multipleSelection.forEach(function(a){a===t.tableData[e].name&&t.tableData.splice(e,1)})};for(var a in this.tableData)e(a)},toAdd:function(){this.isEdit=!0,this.tableData.push({id:void 0,name:"",fullScore:"",desc:""})},update:function(){var t=this;o.a.post("/teacher_api/update_temp",{tid:this.query,class:this.cla,proid:this.pro},{headers:{"X-CSRFToken":document.cookie.split("=")[1]}}).then(function(e){200===e.data.status?t.tableData=e.data.tableData:t.$message(e.data.msg)})},editDone:function(){var t=this;console.log(this.tableData),""!==this.cla&&""!==this.pro?(this.isEdit=!1,o.a.post("/teacher_api/edit_temp",{tid:this.query,tableData:this.tableData,class:this.cla,proid:this.pro},{headers:{"X-CSRFToken":document.cookie.split("=")[1]}}).then(function(e){200===e.data.status?t.$message("成功修改"):t.$message(e.data.msg)})):this.$message("请选择课程和Project")}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"mark"}},[a("el-container",{staticClass:"all-background"},[a("el-header",{staticStyle:{"text-align":"left","font-size":"20px",color:"#ffff"}},[a("el-row",{staticStyle:{margin:"auto 15%"}},[a("HeadLine",{attrs:{id:this.query}})],1)],1),t._v(" "),a("el-main",[a("div",{staticClass:"main-class"},[a("br"),t._v(" "),a("div",{staticStyle:{margin:"0.5% 3%",width:"94%"}},[a("el-select",{staticStyle:{width:"48%"},attrs:{placeholder:"请选择课程"},model:{value:t.cla,callback:function(e){t.cla=e},expression:"cla"}},t._l(t.classes,function(t){return a("el-option",{key:t.$index,attrs:{label:t,value:t}})}),1),t._v(" "),a("el-select",{staticStyle:{float:"right",width:"48%"},attrs:{placeholder:"请选择Project"},on:{change:t.update},model:{value:t.pro,callback:function(e){t.pro=e},expression:"pro"}},t._l(t.pros[t.cla],function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("div",{staticStyle:{margin:"0.5% 3%",width:"96%"}},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.isEdit=!0}}},[t._v(" 编辑 ")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.toAdd}},[t._v(" 添加 ")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.cancelSelect}},[t._v("取消选择")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.editDone}},[t._v(" 完成 ")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.deleteDone}},[t._v(" 删除 ")]),t._v(" "),a("uploadTemplate",{attrs:{tableData:t.tableData,cla:t.cla,pro:t.pro}})],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"96%",margin:"auto 2%"},attrs:{data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isEdit?a("div",{staticClass:"input-box"},[a("el-input",{attrs:{size:"small"},model:{value:e.row.name,callback:function(a){t.$set(e.row,"name",a)},expression:"scope.row.name"}})],1):a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"fullScore",label:"总分",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isEdit?a("div",{staticClass:"input-box"},[a("el-input",{attrs:{size:"small"},model:{value:e.row.fullScore,callback:function(a){t.$set(e.row,"fullScore",a)},expression:"scope.row.fullScore"}})],1):a("span",[t._v(t._s(e.row.fullScore))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"描述",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isEdit?a("div",{staticClass:"input-box"},[a("el-input",{attrs:{size:"small"},model:{value:e.row.desc,callback:function(a){t.$set(e.row,"desc",a)},expression:"scope.row.desc"}})],1):a("span",[t._v(t._s(e.row.desc))])]}}])})],1)],1)]),t._v(" "),a("el-footer",[a("page-end")],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(d,u,!1,function(t){a("C+So")},"data-v-a8d8ffc8",null);e.default=p.exports},"C+So":function(t,e){},bjel:function(t,e){}});
//# sourceMappingURL=2.8e9a585c9386d272a9ba.js.map